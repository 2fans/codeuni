import telnetlib
import time

host = "192.168.56.101"
username = "tufan"
password = "123"

try:
    tn = telnetlib.Telnet(host)
    print("Connected to " + host)
    
    tn.read_until(b"Username:")
    tn.write(username.encode('ascii') + b"\n")
    
    tn.read_until(b"Password:")
    tn.write(password.encode('ascii') + b"\n")
    
    time.sleep(1)
    output = tn.read_very_eager().decode('ascii')
    print(output)

    tn.write(b"show running-config\n")
    
    time.sleep(3)
    
    running_config = tn.read_very_eager().decode('ascii')
    print(running_config)
    
    file = open("running_config.txt", "w")
    file.write(running_config)
    file.close()
    print("Running configuration saved to running_config.txt")

    while True:
        command = input("Enter command: ")
        if command.lower() == "exit" or command.lower() == "quit":
            print("Exiting Telnet session...")
            tn.write(b"exit\n")
            break
        
        tn.write(command.encode('ascii') + b"\n")
        
        time.sleep(1)
        
        output = tn.read_very_eager().decode('ascii')
        print(output)

except:
    print("An error occurred.")

finally:
    try:
        tn.close()
    except:
        pass
    print("Connection closed.")



